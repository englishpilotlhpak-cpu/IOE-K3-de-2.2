<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BỘ ĐỀ ÔN IOE K3 SỐ: 02.2</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700;800&display=swap');
        body {
            font-family: 'Baloo 2', cursive;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .word-block {
            user-select: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        audio {
            filter: sepia(20%) saturate(70%) grayscale(1) contrast(99%) brightness(90%);
        }
    </style>
</head>
<body class="bg-blue-50 font-sans antialiased text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        // --- DỮ LIỆU CÂU HỎI IOE LỚP 3 (ĐỀ SỐ 02.2) - 100 CÂU ---
        const questions = [
            {
                type: 'multimedia',
                question: '101. There are … sweets.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/11/30/636161037811773395_Audio.mp3',
                options: [
                    { text: 'A. three', isCorrect: true },
                    { text: 'B. two', isCorrect: false },
                    { text: 'C. four', isCorrect: false },
                    { text: 'D. no', isCorrect: false }
                ],
                correctAnswer: 'A. three',
                correctAnswer_vi: 'ba',
                hint_vi: 'Nghe và đếm số lượng kẹo.',
                rationale_vi: 'Trong bài nghe, có thể nghe thấy "three sweets" (ba cái kẹo).',
                rationale_en: 'In the audio, you can hear "three sweets".'
            },
            {
                type: 'multimedia',
                question: '102. Point and s_ y.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Audio/4-dt-38.mp3',
                correctAnswer: 'a',
                correctAnswer_vi: 'a',
                hint_vi: 'Từ có nghĩa là "nói". (1 ký tự)',
                rationale_vi: 'Cụm từ "Point and say" có nghĩa là "Chỉ và nói".',
                rationale_en: 'The phrase "Point and say" means "Point and say".'
            },
            {
                type: 'mc',
                question: '103. ... your name?',
                options: [
                    { text: 'A. What', isCorrect: false },
                    { text: 'B. What’s', isCorrect: true },
                    { text: 'C. How’s', isCorrect: false },
                    { text: 'D. Why’s', isCorrect: false }
                ],
                correctAnswer: 'B. What’s',
                correctAnswer_vi: 'Tên bạn là gì',
                hint_vi: 'Câu hỏi về tên.',
                rationale_vi: '"What\'s" là viết tắt của "What is". Câu "What\'s your name?" là cách hỏi tên chính xác.',
                rationale_en: '"What\'s" is a contraction of "What is". The question "What\'s your name?" is the correct way to ask for a name.'
            },
            {
                type: 'rearrange',
                question: '104. Nice to/ Mary./ meet you./ Hi,/',
                words: ["Hi,", "Mary.", "Nice to", "meet you."],
                correctAnswer: "Hi, Mary. Nice to meet you.",
                correctAnswer_vi: 'Chào, Mary. Rất vui được gặp bạn.',
                hint_vi: 'Đây là một lời chào hỏi.',
                rationale_vi: 'Đây là một đoạn hội thoại chào hỏi thông thường, bắt đầu bằng "Hi".',
                rationale_en: 'This is a common greeting conversation, starting with "Hi".'
            },
            {
                type: 'mc',
                question: '105. Choose the odd one out:',
                options: [
                    { text: 'A. you', isCorrect: false },
                    { text: 'B. I', isCorrect: false },
                    { text: 'C. she', isCorrect: false },
                    { text: 'D. my', isCorrect: true }
                ],
                correctAnswer: 'D. my',
                correctAnswer_vi: 'của tôi',
                hint_vi: 'Tìm từ không phải là đại từ nhân xưng.',
                rationale_vi: '"you", "I", "she" là các đại từ nhân xưng làm chủ ngữ. "my" là tính từ sở hữu.',
                rationale_en: '"you", "I", "she" are subject pronouns. "my" is a possessive adjective.'
            },
            {
                type: 'fill-in-the-blank',
                question: '106. I’m fine, ____k you.',
                correctAnswer: 'than',
                correctAnswer_vi: 'than',
                hint_vi: 'Từ có nghĩa là "cảm ơn". (4 ký tự)',
                rationale_vi: 'Từ đúng là "thank". Cụm từ "thank you" có nghĩa là cảm ơn bạn.',
                rationale_en: 'The correct word is "thank". The phrase "thank you" means thank you.'
            },
            {
                type: 'mc',
                question: '107. I ... Maths and Arts on Monday.',
                options: [
                    { text: 'A. play', isCorrect: false },
                    { text: 'B. say', isCorrect: false },
                    { text: 'C. study', isCorrect: true },
                    { text: 'D. look', isCorrect: false }
                ],
                correctAnswer: 'C. study',
                correctAnswer_vi: 'học',
                hint_vi: 'Hành động với các môn học.',
                rationale_vi: 'Chúng ta "study" (học) các môn học như Toán (Maths) và Mỹ thuật (Arts).',
                rationale_en: 'We "study" subjects like Maths and Arts.'
            },
            {
                type: 'rearrange',
                question: '108. is short./ is small/ My rubber/ and my ruler/',
                words: ["My rubber", "is small", "and my ruler", "is short."],
                correctAnswer: "My rubber is small and my ruler is short.",
                correctAnswer_vi: 'Cục tẩy của tôi nhỏ và cây thước của tôi ngắn.',
                hint_vi: 'Mô tả hai đồ vật.',
                rationale_vi: 'Câu này mô tả đặc điểm của hai đồ dùng học tập: cục tẩy và cây thước.',
                rationale_en: 'This sentence describes the characteristics of two school supplies: the rubber and the ruler.'
            },
            {
                type: 'mc',
                question: '109. I’m fine, thank ... .',
                options: [
                    { text: 'A. yous', isCorrect: false },
                    { text: 'B. you’s', isCorrect: false },
                    { text: 'C. you’re', isCorrect: false },
                    { text: 'D. you', isCorrect: true }
                ],
                correctAnswer: 'D. you',
                correctAnswer_vi: 'bạn',
                hint_vi: 'Cụm từ cảm ơn.',
                rationale_vi: 'Cụm từ đúng và lịch sự là "thank you".',
                rationale_en: 'The correct and polite phrase is "thank you".'
            },
            {
                type: 'fill-in-the-blank',
                question: '110. Sit do_n, please.',
                correctAnswer: 'w',
                correctAnswer_vi: 'w',
                hint_vi: 'Cụm từ có nghĩa là "mời ngồi". (1 ký tự)',
                rationale_vi: 'Cụm từ đúng là "sit down".',
                rationale_en: 'The correct phrase is "sit down".'
            },
            {
                type: 'rearrange',
                question: '111. my/ is/ friend./ Jenny/',
                words: ["Jenny", "is", "my", "friend."],
                correctAnswer: "Jenny is my friend.",
                correctAnswer_vi: 'Jenny là bạn của tôi.',
                hint_vi: 'Giới thiệu một người bạn.',
                rationale_vi: 'Cấu trúc câu giới thiệu: Tên + is + my friend.',
                rationale_en: 'Introduction sentence structure: Name + is + my friend.'
            },
            {
                type: 'rearrange',
                question: '112. May/ I/ borrow/ your notebook?',
                words: ["May", "I", "borrow", "your notebook?"],
                correctAnswer: "May I borrow your notebook?",
                correctAnswer_vi: 'Tôi có thể mượn vở của bạn được không?',
                hint_vi: 'Câu hỏi xin phép.',
                rationale_vi: 'Đây là cấu trúc câu hỏi xin phép một cách lịch sự, bắt đầu bằng "May I".',
                rationale_en: 'This is a polite structure for asking permission, starting with "May I".'
            },
            {
                type: 'rearrange',
                question: '113. your/ Where/ are/ books?',
                words: ["Where", "are", "your", "books?"],
                correctAnswer: "Where are your books?",
                correctAnswer_vi: 'Sách của bạn ở đâu?',
                hint_vi: 'Câu hỏi về vị trí.',
                rationale_vi: 'Câu hỏi về vị trí của vật số nhiều bắt đầu bằng "Where are".',
                rationale_en: 'A question about the location of plural objects starts with "Where are".'
            },
            {
                type: 'rearrange',
                question: '114. bag./ a purple/ This is/',
                words: ["This is", "a purple", "bag."],
                correctAnswer: "This is a purple bag.",
                correctAnswer_vi: 'Đây là một cái túi màu tím.',
                hint_vi: 'Bắt đầu với "This is".',
                rationale_vi: 'Câu giới thiệu đồ vật: This is + a/an + tính từ + danh từ.',
                rationale_en: 'Sentence to introduce an object: This is + a/an + adjective + noun.'
            },
            {
                type: 'mc',
                question: '115. Where are ... from?',
                options: [
                    { text: 'A. and', isCorrect: false },
                    { text: 'B. my', isCorrect: false },
                    { text: 'C. you', isCorrect: true },
                    { text: 'D. she', isCorrect: false }
                ],
                correctAnswer: 'C. you',
                correctAnswer_vi: 'bạn',
                hint_vi: 'Câu hỏi về quê quán.',
                rationale_vi: 'Câu hỏi "Where are you from?" (Bạn từ đâu đến?) dùng động từ "are" với chủ ngữ "you".',
                rationale_en: 'The question "Where are you from?" uses the verb "are" with the subject "you".'
            },
            {
                type: 'rearrange',
                question: '116. Mai and Phong?/ How/ you today,/ are/',
                words: ["How", "are", "you today,", "Mai and Phong?"],
                correctAnswer: "How are you today, Mai and Phong?",
                correctAnswer_vi: 'Hôm nay các bạn khỏe không, Mai và Phong?',
                hint_vi: 'Câu hỏi thăm sức khỏe.',
                rationale_vi: 'Đây là câu hỏi thăm sức khỏe cho nhiều người, bắt đầu bằng "How are".',
                rationale_en: 'This is a question asking about the well-being of multiple people, starting with "How are".'
            },
            {
                type: 'fill-in-the-blank',
                question: '117. Bye. ___ you later.',
                correctAnswer: 'See',
                correctAnswer_vi: 'See',
                hint_vi: 'Cụm từ chào tạm biệt. (3 ký tự)',
                rationale_vi: 'Cụm từ "See you later" có nghĩa là "Hẹn gặp lại sau".',
                rationale_en: 'The phrase "See you later" means "See you later".'
            },
            {
                type: 'rearrange',
                question: '118. after/ repeat/ me./ Please/',
                words: ["Please", "repeat", "after", "me."],
                correctAnswer: "Please repeat after me.",
                correctAnswer_vi: 'Làm ơn lặp lại theo tôi.',
                hint_vi: 'Bắt đầu với "Please".',
                rationale_vi: 'Đây là một câu yêu cầu lịch sự, thường được giáo viên sử dụng.',
                rationale_en: 'This is a polite request, often used by teachers.'
            },
            {
                type: 'mc',
                question: '119. A: What colour is this? - B: It’s ... .',
                options: [
                    { text: 'A. book', isCorrect: false },
                    { text: 'B. a green', isCorrect: false },
                    { text: 'C. green', isCorrect: true },
                    { text: 'D. pencil', isCorrect: false }
                ],
                correctAnswer: 'C. green',
                correctAnswer_vi: 'màu xanh lá',
                hint_vi: 'Câu trả lời phải là một màu sắc.',
                rationale_vi: 'Câu hỏi là về màu sắc, vì vậy câu trả lời chỉ cần nêu tên màu sắc.',
                rationale_en: 'The question is about color, so the answer just needs to state the color.'
            },
            {
                type: 'mc',
                question: '120. Open ... book, please.',
                options: [
                    { text: 'A. you', isCorrect: false },
                    { text: 'B. your', isCorrect: true },
                    { text: 'C. you’s', isCorrect: false },
                    { text: 'D. your’s', isCorrect: false }
                ],
                correctAnswer: 'B. your',
                correctAnswer_vi: 'của bạn',
                hint_vi: 'Tính từ sở hữu.',
                rationale_vi: '"your" là tính từ sở hữu đứng trước danh từ "book" để chỉ "sách của bạn".',
                rationale_en: '"your" is a possessive adjective placed before the noun "book" to mean "your book".'
            },
            {
                type: 'fill-in-the-blank',
                question: '121. __ this a ruler? – Yes, it is.',
                correctAnswer: 'Is',
                correctAnswer_vi: 'Is',
                hint_vi: 'Câu hỏi Yes/No với "this". (2 ký tự)',
                rationale_vi: 'Để hỏi về một vật số ít ("this ruler"), ta bắt đầu câu hỏi Yes/No bằng "Is".',
                rationale_en: 'To ask about a singular object ("this ruler"), we start a Yes/No question with "Is".'
            },
            {
                type: 'fill-in-the-blank',
                question: '122. Listen __ me, please.',
                correctAnswer: 'to',
                correctAnswer_vi: 'to',
                hint_vi: 'Cụm từ "listen to". (2 ký tự)',
                rationale_vi: 'Cụm động từ "listen to" có nghĩa là "lắng nghe (ai đó/cái gì đó)".',
                rationale_en: 'The phrasal verb "listen to" means to listen to (someone/something).'
            },
            {
                type: 'multimedia',
                question: '123. That is my ho__e.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/22/635207345145450116_566X320.jpg',
                correctAnswer: 'us',
                correctAnswer_vi: 'us',
                hint_vi: 'Từ có nghĩa là "ngôi nhà". (2 ký tự)',
                rationale_vi: 'Từ đúng là "house" (ngôi nhà).',
                rationale_en: 'The correct word is "house".'
            },
            {
                type: 'multimedia',
                question: '124. Nam\'s pencils are_____ .',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Audio/2-tn-23.mp3',
                options: [
                    { text: 'A. black', isCorrect: false },
                    { text: 'B. blue', isCorrect: false },
                    { text: 'C. green', isCorrect: true },
                    { text: 'D. red', isCorrect: false }
                ],
                correctAnswer: 'C. green',
                correctAnswer_vi: 'màu xanh lá',
                hint_vi: 'Nghe và chọn màu sắc.',
                rationale_vi: 'Bài nghe mô tả những cây bút chì của Nam có màu "green" (xanh lá).',
                rationale_en: 'The audio describes Nam\'s pencils as "green".'
            },
            {
                type: 'multimedia',
                question: '125. Where is the ...?',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206313406004155_Audio.mp3',
                options: [
                    { text: 'A. bus', isCorrect: true },
                    { text: 'B. class', isCorrect: false },
                    { text: 'C. lab', isCorrect: false },
                    { text: 'D. tab', isCorrect: false }
                ],
                correctAnswer: 'A. bus',
                correctAnswer_vi: 'xe buýt',
                hint_vi: 'Nghe và chọn từ đúng.',
                rationale_vi: 'Bài nghe hỏi "Where is the bus?".',
                rationale_en: 'The audio asks "Where is the bus?".'
            },
            {
                type: 'multimedia',
                question: '126. E_GHT',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Images/2-dt-41.jpg',
                correctAnswer: 'I',
                correctAnswer_vi: 'I',
                hint_vi: 'Từ chỉ số 8. (1 ký tự)',
                rationale_vi: 'Từ đúng là "EIGHT" (số tám).',
                rationale_en: 'The correct word is "EIGHT".'
            },
            {
                type: 'mc',
                question: '127. How do you … your name? – That’s A-N-N-E.',
                options: [
                    { text: 'A. spell', isCorrect: true },
                    { text: 'B. read', isCorrect: false },
                    { text: 'C. call', isCorrect: false },
                    { text: 'D. say', isCorrect: false }
                ],
                correctAnswer: 'A. spell',
                correctAnswer_vi: 'đánh vần',
                hint_vi: 'Hành động đánh vần từng chữ cái.',
                rationale_vi: 'Câu hỏi "How do you spell...?" được dùng để hỏi về cách đánh vần.',
                rationale_en: 'The question "How do you spell...?" is used to ask for spelling.'
            },
            {
                type: 'rearrange',
                question: '128. your/ Raise/ hand./',
                words: ["Raise", "your", "hand."],
                correctAnswer: "Raise your hand.",
                correctAnswer_vi: 'Giơ tay bạn lên.',
                hint_vi: 'Một câu yêu cầu.',
                rationale_vi: 'Cụm từ "Raise your hand" là một yêu cầu phổ biến trong lớp học.',
                rationale_en: '"Raise your hand" is a common classroom request.'
            },
            {
                type: 'mc',
                question: '129. Choose the odd one out',
                options: [
                    { text: 'A. Ruler', isCorrect: false },
                    { text: 'B. Pen', isCorrect: false },
                    { text: 'C. Book', isCorrect: false },
                    { text: 'D. Library', isCorrect: true }
                ],
                correctAnswer: 'D. Library',
                correctAnswer_vi: 'Thư viện',
                hint_vi: 'Tìm từ không phải là đồ dùng học tập.',
                rationale_vi: '"Ruler", "Pen", "Book" là các đồ dùng học tập. "Library" là một địa điểm.',
                rationale_en: '"Ruler", "Pen", "Book" are school supplies. "Library" is a place.'
            },
            {
                type: 'fill-in-the-blank',
                question: '130. LIS_EN',
                correctAnswer: 'T',
                correctAnswer_vi: 'T',
                hint_vi: 'Từ có nghĩa là "lắng nghe". (1 ký tự)',
                rationale_vi: 'Từ đúng là "LISTEN".',
                rationale_en: 'The correct word is "LISTEN".'
            },
            {
                type: 'fill-in-the-blank',
                question: '131. Nam’s pencil is ____ but mine is short.',
                correctAnswer: 'long',
                correctAnswer_vi: 'dài',
                hint_vi: 'Trái nghĩa với "short". (4 ký tự)',
                rationale_vi: 'Từ trái nghĩa với "short" (ngắn) là "long" (dài).',
                rationale_en: 'The opposite of "short" is "long".'
            },
            {
                type: 'fill-in-the-blank',
                question: '132. Gi_e me the book, please.',
                correctAnswer: 'v',
                correctAnswer_vi: 'v',
                hint_vi: 'Từ có nghĩa là "đưa". (1 ký tự)',
                rationale_vi: 'Từ đúng là "Give".',
                rationale_en: 'The correct word is "Give".'
            },
            {
                type: 'fill-in-the-blank',
                question: '133. My n_me is Hieu.',
                correctAnswer: 'a',
                correctAnswer_vi: 'a',
                hint_vi: 'Từ có nghĩa là "tên". (1 ký tự)',
                rationale_vi: 'Từ đúng là "name".',
                rationale_en: 'The correct word is "name".'
            },
            {
                type: 'multimedia',
                question: '134. ____ the bag, please.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/22/635207366284327721_566X320.jpg',
                correctAnswer: 'Open',
                correctAnswer_vi: 'Mở',
                hint_vi: 'Hành động với cái túi. (4 ký tự)',
                rationale_vi: 'Hành động phù hợp với hình ảnh là "Open the bag" (Mở cái túi ra).',
                rationale_en: 'The appropriate action for the image is "Open the bag".'
            },
            {
                type: 'rearrange',
                question: '135. go to/ school/ don\'t/ I/ today./',
                words: ["I", "don't", "go to", "school", "today."],
                correctAnswer: "I don't go to school today.",
                correctAnswer_vi: 'Hôm nay tôi không đến trường.',
                hint_vi: 'Câu phủ định.',
                rationale_vi: 'Cấu trúc câu phủ định ở thì hiện tại đơn: I + don\'t + V.',
                rationale_en: 'Negative sentence structure in the simple present: I + don\'t + V.'
            },
            {
                type: 'rearrange',
                question: '136. teacher./ Listen to/ the/',
                words: ["Listen to", "the", "teacher."],
                correctAnswer: "Listen to the teacher.",
                correctAnswer_vi: 'Lắng nghe giáo viên.',
                hint_vi: 'Bắt đầu với "Listen to".',
                rationale_vi: 'Đây là một câu mệnh lệnh.',
                rationale_en: 'This is a command.'
            },
            {
                type: 'mc',
                question: '137. This isn’t ... ruler. It’s my ruler.',
                options: [
                    { text: 'A. he’s', isCorrect: false },
                    { text: 'B. his', isCorrect: true },
                    { text: 'C. me’s', isCorrect: false },
                    { text: 'D. you’s', isCorrect: false }
                ],
                correctAnswer: 'B. his',
                correctAnswer_vi: 'của anh ấy',
                hint_vi: 'Tính từ sở hữu.',
                rationale_vi: '"his" là tính từ sở hữu chỉ "của anh ấy", đứng trước danh từ "ruler".',
                rationale_en: '"his" is a possessive adjective meaning "belonging to him", placed before the noun "ruler".'
            },
            {
                type: 'fill-in-the-blank',
                question: '138. Mary is at sch__l.',
                correctAnswer: 'oo',
                correctAnswer_vi: 'oo',
                hint_vi: 'Từ có nghĩa là "trường học". (2 ký tự)',
                rationale_vi: 'Từ đúng là "school".',
                rationale_en: 'The correct word is "school".'
            },
            {
                type: 'fill-in-the-blank',
                question: '139. David and Tony p__y football after school.',
                correctAnswer: 'la',
                correctAnswer_vi: 'la',
                hint_vi: 'Từ có nghĩa là "chơi". (2 ký tự)',
                rationale_vi: 'Từ đúng là "play".',
                rationale_en: 'The correct word is "play".'
            },
            {
                type: 'rearrange',
                question: '140. are/ My/ pink./ shoes/ new/',
                words: ["My", "new", "shoes", "are", "pink."],
                correctAnswer: "My new shoes are pink.",
                correctAnswer_vi: 'Đôi giày mới của tôi màu hồng.',
                hint_vi: 'Mô tả đôi giày.',
                rationale_vi: 'Cấu trúc câu: S (My new shoes) + be (are) + adj (pink).',
                rationale_en: 'Sentence structure: S (My new shoes) + be (are) + adj (pink).'
            },
            {
                type: 'fill-in-the-blank',
                question: '141. Gi_e me a pen, please.',
                correctAnswer: 'v',
                correctAnswer_vi: 'v',
                hint_vi: 'Từ có nghĩa là "đưa". (1 ký tự)',
                rationale_vi: 'Từ đúng là "Give".',
                rationale_en: 'The correct word is "Give".'
            },
            {
                type: 'fill-in-the-blank',
                question: '142. St__d up, please.',
                correctAnswer: 'an',
                correctAnswer_vi: 'an',
                hint_vi: 'Cụm từ "stand up". (2 ký tự)',
                rationale_vi: 'Cụm từ "Stand up" có nghĩa là "Đứng lên".',
                rationale_en: 'The phrase "Stand up" means to stand up.'
            },
            {
                type: 'fill-in-the-blank',
                question: '143. Is th___ any water in the fridge, mom?',
                correctAnswer: 'ere',
                correctAnswer_vi: 'ere',
                hint_vi: 'Cấu trúc "Is there". (3 ký tự)',
                rationale_vi: 'Cấu trúc "Is there...?" dùng để hỏi về sự tồn tại của một vật gì đó (số ít).',
                rationale_en: 'The structure "Is there...?" is used to ask about the existence of something (singular).'
            },
            {
                type: 'fill-in-the-blank',
                question: '144. ___ many students are there in your classroom?',
                correctAnswer: 'How',
                correctAnswer_vi: 'How',
                hint_vi: 'Câu hỏi về số lượng. (3 ký tự)',
                rationale_vi: 'Cụm từ "How many" dùng để hỏi về số lượng.',
                rationale_en: 'The phrase "How many" is used to ask about quantity.'
            },
            {
                type: 'mc',
                question: '145. …, students. See you tomorrow.',
                options: [
                    { text: 'A. Good morning', isCorrect: false },
                    { text: 'B. Good night', isCorrect: false },
                    { text: 'C. Goodbye', isCorrect: true },
                    { text: 'D. Nice to meet you', isCorrect: false }
                ],
                correctAnswer: 'C. Goodbye',
                correctAnswer_vi: 'Tạm biệt',
                hint_vi: 'Dựa vào câu "See you tomorrow".',
                rationale_vi: '"See you tomorrow" (Hẹn gặp lại vào ngày mai) cho thấy đây là một lời chào tạm biệt.',
                rationale_en: '"See you tomorrow" indicates that this is a farewell.'
            },
            {
                type: 'rearrange',
                question: '146. your/ Don\'t/ bike/ too fast./ ride/',
                words: ["Don't", "ride", "your", "bike", "too fast."],
                correctAnswer: "Don't ride your bike too fast.",
                correctAnswer_vi: 'Đừng đi xe đạp của bạn quá nhanh.',
                hint_vi: 'Câu mệnh lệnh phủ định.',
                rationale_vi: 'Câu mệnh lệnh phủ định bắt đầu bằng "Don\'t".',
                rationale_en: 'Negative commands start with "Don\'t".'
            },
            {
                type: 'fill-in-the-blank',
                question: '147. She is my tea__er.',
                correctAnswer: 'ch',
                correctAnswer_vi: 'ch',
                hint_vi: 'Từ có nghĩa là "giáo viên". (2 ký tự)',
                rationale_vi: 'Từ đúng là "teacher".',
                rationale_en: 'The correct word is "teacher".'
            },
            {
                type: 'fill-in-the-blank',
                question: '148. M_THER',
                correctAnswer: 'O',
                correctAnswer_vi: 'O',
                hint_vi: 'Từ có nghĩa là "mẹ". (1 ký tự)',
                rationale_vi: 'Từ đúng là "MOTHER".',
                rationale_en: 'The correct word is "MOTHER".'
            },
            {
                type: 'rearrange',
                question: '149. books/ in/ your school bag?/ are there/ How many/',
                words: ["How many", "books", "are there", "in", "your school bag?"],
                correctAnswer: "How many books are there in your school bag?",
                correctAnswer_vi: 'Có bao nhiêu quyển sách trong cặp của bạn?',
                hint_vi: 'Bắt đầu với "How many".',
                rationale_vi: 'Cấu trúc hỏi số lượng: How many + N(plural) + are there + location?',
                rationale_en: 'Structure for asking quantity: How many + N(plural) + are there + location?'
            },
            {
                type: 'rearrange',
                question: '150. down./ Put/ your pencil/',
                words: ["Put", "your pencil", "down."],
                correctAnswer: "Put your pencil down.",
                correctAnswer_vi: 'Đặt bút chì của bạn xuống.',
                hint_vi: 'Một câu yêu cầu.',
                rationale_vi: 'Đây là một câu mệnh lệnh.',
                rationale_en: 'This is a command.'
            },
            {
                type: 'multimedia',
                question: '151. Does she have bl____ hair?',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/16/636174959719066879_566X320.jpg',
                correctAnswer: 'onde',
                correctAnswer_vi: 'onde',
                hint_vi: 'Màu tóc vàng hoe. (4 ký tự)',
                rationale_vi: 'Cô gái trong hình có mái tóc "blonde" (vàng hoe).',
                rationale_en: 'The girl in the picture has "blonde" hair.'
            },
            {
                type: 'fill-in-the-blank',
                question: '152. Pl___sed to meet you, Linda.',
                correctAnswer: 'ea',
                correctAnswer_vi: 'ea',
                hint_vi: 'Cụm từ chào hỏi. (2 ký tự)',
                rationale_vi: 'Từ đúng là "Pleased". Cụm từ "Pleased to meet you" là cách nói trang trọng hơn của "Nice to meet you".',
                rationale_en: 'The correct word is "Pleased". "Pleased to meet you" is a more formal way of saying "Nice to meet you".'
            },
            {
                type: 'multimedia',
                question: '153. My school .... is small.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/2/636505008466109219_566X320.jpg',
                options: [
                    { text: 'A. playground', isCorrect: false },
                    { text: 'B. library', isCorrect: false },
                    { text: 'C. classroom', isCorrect: true },
                    { text: 'D. gym', isCorrect: false }
                ],
                correctAnswer: 'C. classroom',
                correctAnswer_vi: 'lớp học',
                hint_vi: 'Xem hình và chọn địa điểm.',
                rationale_vi: 'Hình ảnh cho thấy một "classroom" (lớp học) nhỏ.',
                rationale_en: 'The image shows a small "classroom".'
            },
            {
                type: 'multimedia',
                question: '154. ____ are my crayons.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/1/2/636504891760936521_Audio.mp3',
                correctAnswer: 'These',
                correctAnswer_vi: 'Đây là',
                hint_vi: 'Đại từ chỉ định số nhiều. (5 ký tự)',
                rationale_vi: 'Bài nghe nói "These are my crayons" (Đây là những cây bút sáp của tôi).',
                rationale_en: 'The audio says "These are my crayons".'
            },
            {
                type: 'rearrange',
                question: '155. Does/ basketball?/ she like/ volleyball/ or',
                words: ["Does", "she like", "volleyball", "or", "basketball?"],
                correctAnswer: "Does she like volleyball or basketball?",
                correctAnswer_vi: 'Cô ấy thích bóng chuyền hay bóng rổ?',
                hint_vi: 'Câu hỏi lựa chọn.',
                rationale_vi: 'Đây là câu hỏi lựa chọn (or) ở thì hiện tại đơn.',
                rationale_en: 'This is a choice question (or) in the simple present tense.'
            },
            {
                type: 'mc',
                question: '156. This is ... cat.',
                options: [
                    { text: 'A. he', isCorrect: false },
                    { text: 'B. she', isCorrect: false },
                    { text: 'C. my', isCorrect: true },
                    { text: 'D. you', isCorrect: false }
                ],
                correctAnswer: 'C. my',
                correctAnswer_vi: 'của tôi',
                hint_vi: 'Tính từ sở hữu.',
                rationale_vi: '"my" là tính từ sở hữu đứng trước danh từ "cat".',
                rationale_en: '"my" is a possessive adjective placed before the noun "cat".'
            },
            {
                type: 'mc',
                question: '157. Choose the odd one out:',
                options: [
                    { text: 'A. eraser', isCorrect: false },
                    { text: 'B. ruler', isCorrect: false },
                    { text: 'C. name', isCorrect: true },
                    { text: 'D. pen', isCorrect: false }
                ],
                correctAnswer: 'C. name',
                correctAnswer_vi: 'tên',
                hint_vi: 'Tìm từ không phải đồ dùng học tập.',
                rationale_vi: '"eraser", "ruler", "pen" là đồ dùng học tập. "name" là danh từ chỉ tên gọi.',
                rationale_en: '"eraser", "ruler", "pen" are school supplies. "name" is a noun referring to a name.'
            },
            {
                type: 'rearrange',
                question: '158. an/ like/ ice cream?/ you/ Would/',
                words: ["Would", "you", "like", "an", "ice cream?"],
                correctAnswer: "Would you like an ice cream?",
                correctAnswer_vi: 'Bạn có muốn ăn một cây kem không?',
                hint_vi: 'Câu mời.',
                rationale_vi: 'Cấu trúc mời ai đó một cách lịch sự: Would you like...?',
                rationale_en: 'Structure for a polite invitation: Would you like...?'
            },
            {
                type: 'fill-in-the-blank',
                question: '159. ___, he is.',
                correctAnswer: 'Yes',
                correctAnswer_vi: 'Vâng',
                hint_vi: 'Câu trả lời khẳng định. (3 ký tự)',
                rationale_vi: 'Câu trả lời cho câu hỏi Yes/No, dạng khẳng định.',
                rationale_en: 'An affirmative answer to a Yes/No question.'
            },
            {
                type: 'fill-in-the-blank',
                question: '160. My brother likes to play computer g____.',
                correctAnswer: 'ames',
                correctAnswer_vi: 'ames',
                hint_vi: 'Trò chơi trên máy tính. (4 ký tự)',
                rationale_vi: 'Từ đúng là "games". Cụm từ "computer games" có nghĩa là trò chơi điện tử.',
                rationale_en: 'The correct word is "games". The phrase "computer games" means video games.'
            },
            {
                type: 'multimedia',
                question: '161. Two maps __ on the wall.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Images/4-tn-56.jpg',
                options: [
                    { text: 'A. are', isCorrect: true },
                    { text: 'B. is', isCorrect: false },
                    { text: 'C. re', isCorrect: false },
                    { text: 'D. am', isCorrect: false }
                ],
                correctAnswer: 'A. are',
                correctAnswer_vi: 'thì',
                hint_vi: 'Chủ ngữ là "Two maps".',
                rationale_vi: 'Chủ ngữ "Two maps" là số nhiều, nên ta dùng động từ "are".',
                rationale_en: 'The subject "Two maps" is plural, so we use the verb "are".'
            },
            {
                type: 'mc',
                question: '162. Choose the odd one out:',
                options: [
                    { text: 'A. how', isCorrect: true },
                    { text: 'B. hello', isCorrect: false },
                    { text: 'C. hi', isCorrect: false },
                    { text: 'D. good morning', isCorrect: false }
                ],
                correctAnswer: 'A. how',
                correctAnswer_vi: 'như thế nào',
                hint_vi: 'Tìm từ không phải là lời chào.',
                rationale_vi: '"hello", "hi", "good morning" là các lời chào. "how" là từ để hỏi.',
                rationale_en: '"hello", "hi", "good morning" are greetings. "how" is a question word.'
            },
            {
                type: 'mc',
                question: '163. Choose the odd one out:',
                options: [
                    { text: 'A. book', isCorrect: false },
                    { text: 'B. pencil', isCorrect: false },
                    { text: 'C. rubber', isCorrect: false },
                    { text: 'D. library', isCorrect: true }
                ],
                correctAnswer: 'D. library',
                correctAnswer_vi: 'thư viện',
                hint_vi: 'Tìm từ không phải là đồ dùng học tập.',
                rationale_vi: '"book", "pencil", "rubber" là đồ dùng học tập. "library" là một nơi chốn.',
                rationale_en: '"book", "pencil", "rubber" are school supplies. "library" is a place.'
            },
            {
                type: 'mc',
                question: '164. Choose the odd one out:',
                options: [
                    { text: 'A. you', isCorrect: false },
                    { text: 'B. hi', isCorrect: true },
                    { text: 'C. I', isCorrect: false },
                    { text: 'D. She', isCorrect: false }
                ],
                correctAnswer: 'B. hi',
                correctAnswer_vi: 'chào',
                hint_vi: 'Tìm từ không phải là đại từ nhân xưng.',
                rationale_vi: '"you", "I", "She" là các đại từ nhân xưng. "hi" là một lời chào.',
                rationale_en: '"you", "I", "She" are personal pronouns. "hi" is a greeting.'
            },
            {
                type: 'fill-in-the-blank',
                question: '165. W___ are these? – These are pencil cases.',
                correctAnswer: 'hat',
                correctAnswer_vi: 'hat',
                hint_vi: 'Từ để hỏi "cái gì". (3 ký tự)',
                rationale_vi: 'Từ đúng là "What". Câu hỏi "What are these?" dùng để hỏi về những vật ở gần (số nhiều).',
                rationale_en: 'The correct word is "What". The question "What are these?" is used to ask about nearby objects (plural).'
            },
            {
                type: 'mc',
                question: '166. Choose the odd one out:',
                options: [
                    { text: 'A. young', isCorrect: true },
                    { text: 'B. white', isCorrect: false },
                    { text: 'C. pink', isCorrect: false },
                    { text: 'D. gray', isCorrect: false }
                ],
                correctAnswer: 'A. young',
                correctAnswer_vi: 'trẻ',
                hint_vi: 'Tìm từ không phải là màu sắc.',
                rationale_vi: '"white", "pink", "gray" là các màu sắc. "young" là tính từ chỉ tuổi tác.',
                rationale_en: '"white", "pink", "gray" are colors. "young" is an adjective describing age.'
            },
            {
                type: 'fill-in-the-blank',
                question: '167. Come here and ____ an English song now.',
                correctAnswer: 'sing',
                correctAnswer_vi: 'hát',
                hint_vi: 'Hành động với một bài hát. (4 ký tự)',
                rationale_vi: 'Từ đúng là "sing". "sing a song" có nghĩa là "hát một bài hát".',
                rationale_en: 'The correct word is "sing". "sing a song" means to sing a song.'
            },
            {
                type: 'fill-in-the-blank',
                question: '168. Don\'t talk __ class!',
                correctAnswer: 'in',
                correctAnswer_vi: 'trong',
                hint_vi: 'Giới từ chỉ vị trí. (2 ký tự)',
                rationale_vi: 'Cụm từ "in class" có nghĩa là "ở trong lớp học".',
                rationale_en: 'The phrase "in class" means inside the classroom.'
            },
            {
                type: 'fill-in-the-blank',
                question: '169. Fine, th_nks.',
                correctAnswer: 'a',
                correctAnswer_vi: 'a',
                hint_vi: 'Từ có nghĩa là "cảm ơn". (1 ký tự)',
                rationale_vi: 'Từ đúng là "thanks".',
                rationale_en: 'The correct word is "thanks".'
            },
            {
                type: 'mc',
                question: '170. Choose the letter(s) to make a correct word: pencil c__se',
                options: [
                    { text: 'A. a', isCorrect: true },
                    { text: 'B. e', isCorrect: false },
                    { text: 'C. i', isCorrect: false },
                    { text: 'D. o', isCorrect: false }
                ],
                correctAnswer: 'A. a',
                correctAnswer_vi: 'a',
                hint_vi: 'Từ có nghĩa là "hộp bút".',
                rationale_vi: 'Từ đúng là "pencil case".',
                rationale_en: 'The correct word is "pencil case".'
            },
            {
                type: 'rearrange',
                question: '171. Look/ at/ the/ board.',
                words: ["Look", "at", "the", "board."],
                correctAnswer: "Look at the board.",
                correctAnswer_vi: 'Nhìn lên bảng.',
                hint_vi: 'Bắt đầu với "Look".',
                rationale_vi: 'Cụm động từ "Look at" có nghĩa là "nhìn vào".',
                rationale_en: 'The phrasal verb "Look at" means to look at.'
            },
            {
                type: 'fill-in-the-blank',
                question: '172. A: Who’s that boy? - B: __’s Peter.',
                correctAnswer: 'He',
                correctAnswer_vi: 'He',
                hint_vi: 'Đại từ chỉ "that boy". (2 ký tự)',
                rationale_vi: 'Dùng đại từ "He" để thay thế cho "that boy". "He\'s" là viết tắt của "He is".',
                rationale_en: 'Use the pronoun "He" to replace "that boy". "He\'s" is a contraction of "He is".'
            },
            {
                type: 'rearrange',
                question: '173. too./ The window/ is/ new,/',
                words: ["The window", "is", "new,", "too."],
                correctAnswer: "The window is new, too.",
                correctAnswer_vi: 'Cái cửa sổ cũng mới.',
                hint_vi: 'Từ "too" thường ở cuối câu.',
                rationale_vi: '"too" có nghĩa là "cũng vậy" và thường đứng ở cuối câu khẳng định.',
                rationale_en: '"too" means "also" and is usually placed at the end of an affirmative sentence.'
            },
            {
                type: 'mc',
                question: '174. Choose the incorrect word(s) in the following sentence: Do you like hide seek?',
                options: [
                    { text: 'A. Do', isCorrect: false },
                    { text: 'B. you', isCorrect: false },
                    { text: 'C. like', isCorrect: false },
                    { text: 'D. hide seek', isCorrect: true }
                ],
                correctAnswer: 'D. hide seek',
                correctAnswer_vi: 'hide seek',
                hint_vi: 'Tên một trò chơi.',
                rationale_vi: 'Tên đúng của trò chơi trốn tìm là "hide-and-seek".',
                rationale_en: 'The correct name for the game is "hide-and-seek".'
            },
            {
                type: 'fill-in-the-blank',
                question: '175. Unscramble this word: ’’HOLOCS’’ -> ’’SCHO__’’.',
                correctAnswer: 'OL',
                correctAnswer_vi: 'OL',
                hint_vi: 'Từ có nghĩa là "trường học". (2 ký tự)',
                rationale_vi: 'Các chữ cái trong "HOLOCS" có thể sắp xếp lại thành "SCHOOL".',
                rationale_en: 'The letters in "HOLOCS" can be rearranged to form "SCHOOL".'
            },
            {
                type: 'multimedia',
                question: '176. Is this ___ bike? - No, it isn\'t.',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi%20Th%E1%BB%AD/Thi_trai_nghiem_2021/Lop3/tracnghiem/tn-62.mp3',
                options: [
                    { text: 'A. his', isCorrect: false },
                    { text: 'B. your', isCorrect: true },
                    { text: 'C. my', isCorrect: false },
                    { text: 'D. her', isCorrect: false }
                ],
                correctAnswer: 'B. your',
                correctAnswer_vi: 'của bạn',
                hint_vi: 'Nghe và chọn tính từ sở hữu.',
                rationale_vi: 'Bài nghe hỏi "Is this your bike?".',
                rationale_en: 'The audio asks "Is this your bike?".'
            },
            {
                type: 'multimedia',
                question: '177. My bag is ______.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Images/1-tn-64.jpg',
                options: [
                    { text: 'A. blue', isCorrect: false },
                    { text: 'B. gray', isCorrect: false },
                    { text: 'C. black', isCorrect: true },
                    { text: 'D. yellow', isCorrect: false }
                ],
                correctAnswer: 'C. black',
                correctAnswer_vi: 'màu đen',
                hint_vi: 'Xem màu của cái cặp.',
                rationale_vi: 'Cái cặp trong hình có màu đen.',
                rationale_en: 'The bag in the picture is black.'
            },
            {
                type: 'multimedia',
                question: '178. Choose the sentence that you hear:',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/11/29/637106243647920057_Audio.mp3',
                options: [
                    { text: 'A. I’m fine.', isCorrect: false },
                    { text: 'B. I’m fine, thanks.', isCorrect: true },
                    { text: 'C. Fine, thank you.', isCorrect: false },
                    { text: 'D. I am fine, thank you.', isCorrect: false }
                ],
                correctAnswer: 'B. I’m fine, thanks.',
                correctAnswer_vi: 'Tôi khỏe, cảm ơn.',
                hint_vi: 'Nghe kỹ toàn bộ câu.',
                rationale_vi: 'Bài nghe nói chính xác câu "I’m fine, thanks".',
                rationale_en: 'The audio says the exact sentence "I’m fine, thanks".'
            },
            {
                type: 'fill-in-the-blank',
                question: '179. How are y__?',
                correctAnswer: 'ou',
                correctAnswer_vi: 'ou',
                hint_vi: 'Từ có nghĩa là "bạn". (2 ký tự)',
                rationale_vi: 'Từ đúng là "you".',
                rationale_en: 'The correct word is "you".'
            },
            {
                type: 'rearrange',
                question: '180. pet./ is/ my/ This/',
                words: ["This", "is", "my", "pet."],
                correctAnswer: "This is my pet.",
                correctAnswer_vi: 'Đây là thú cưng của tôi.',
                hint_vi: 'Bắt đầu với "This".',
                rationale_vi: 'Đây là câu giới thiệu thú cưng.',
                rationale_en: 'This is a sentence to introduce a pet.'
            },
            {
                type: 'multimedia',
                question: '181. Sally has bl__ eyes and blonde hair.',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/16/636174948921681281_566X320.jpg',
                correctAnswer: 'ue',
                correctAnswer_vi: 'ue',
                hint_vi: 'Màu xanh nước biển. (2 ký tự)',
                rationale_vi: 'Cô gái trong hình có đôi mắt màu "blue" (xanh nước biển).',
                rationale_en: 'The girl in the picture has "blue" eyes.'
            },
            {
                type: 'mc',
                question: '182. Odd one out:',
                options: [
                    { text: 'A. meet', isCorrect: true },
                    { text: 'B. I', isCorrect: false },
                    { text: 'C. you', isCorrect: false },
                    { text: 'D. he', isCorrect: false }
                ],
                correctAnswer: 'A. meet',
                correctAnswer_vi: 'gặp',
                hint_vi: 'Tìm từ không phải là đại từ.',
                rationale_vi: '"I", "you", "he" là các đại từ. "meet" là một động từ.',
                rationale_en: '"I", "you", "he" are pronouns. "meet" is a verb.'
            },
            {
                type: 'fill-in-the-blank',
                question: '183. It\'s a brow_ teddy bear.',
                correctAnswer: 'n',
                correctAnswer_vi: 'n',
                hint_vi: 'Từ chỉ màu nâu. (1 ký tự)',
                rationale_vi: 'Từ đúng là "brown".',
                rationale_en: 'The correct word is "brown".'
            },
            {
                type: 'fill-in-the-blank',
                question: '184. Horses and sheep live on the ____.',
                correctAnswer: 'farm',
                correctAnswer_vi: 'nông trại',
                hint_vi: 'Nơi có ngựa và cừu. (4 ký tự)',
                rationale_vi: 'Ngựa và cừu là những động vật thường sống ở "farm" (nông trại).',
                rationale_en: 'Horses and sheep are animals that typically live on a "farm".'
            },
            {
                type: 'rearrange',
                question: '185. read/ Let’s/ the/ book.',
                words: ["Let’s", "read", "the", "book."],
                correctAnswer: "Let’s read the book.",
                correctAnswer_vi: 'Chúng ta hãy đọc sách.',
                hint_vi: 'Bắt đầu với "Let\'s".',
                rationale_vi: 'Cấu trúc rủ rê, đề nghị: Let\'s + V.',
                rationale_en: 'Structure for making a suggestion: Let\'s + V.'
            },
            {
                type: 'fill-in-the-blank',
                question: '186. Tha_ is my doll.',
                correctAnswer: 't',
                correctAnswer_vi: 't',
                hint_vi: 'Từ chỉ "đó". (1 ký tự)',
                rationale_vi: 'Từ đúng là "That".',
                rationale_en: 'The correct word is "That".'
            },
            {
                type: 'rearrange',
                question: '187. open/ your/ Stand up/ book./ and/',
                words: ["Stand up", "and", "open", "your", "book."],
                correctAnswer: "Stand up and open your book.",
                correctAnswer_vi: 'Đứng lên và mở sách của bạn ra.',
                hint_vi: 'Hai hành động nối với nhau bằng "and".',
                rationale_vi: 'Đây là câu yêu cầu thực hiện hai hành động liên tiếp.',
                rationale_en: 'This is a request to perform two actions in sequence.'
            },
            {
                type: 'rearrange',
                question: '188. very/ tidy./ isn’t big/ My school/ but/',
                words: ["My school", "isn’t big", "but", "very", "tidy."],
                correctAnswer: "My school isn’t big but very tidy.",
                correctAnswer_vi: 'Trường tôi không lớn nhưng rất gọn gàng.',
                hint_vi: 'Sử dụng "but" để nối hai ý tương phản.',
                rationale_vi: 'Câu này dùng "but" để nối hai mệnh đề có ý nghĩa tương phản.',
                rationale_en: 'This sentence uses "but" to connect two contrasting clauses.'
            },
            {
                type: 'rearrange',
                question: '189. want/ I/ the world./ around/ to travel/',
                words: ["I", "want", "to travel", "around", "the world."],
                correctAnswer: "I want to travel around the world.",
                correctAnswer_vi: 'Tôi muốn đi du lịch vòng quanh thế giới.',
                hint_vi: 'Bắt đầu với "I".',
                rationale_vi: 'Cấu trúc: S + want + to V. Cụm từ "travel around the world" là đi du lịch vòng quanh thế giới.',
                rationale_en: 'Structure: S + want + to V. The phrase "travel around the world" means to travel around the world.'
            },
            {
                type: 'fill-in-the-blank',
                question: '190. It __ a pencil.',
                correctAnswer: 'is',
                correctAnswer_vi: 'is',
                hint_vi: 'Động từ "to be". (2 ký tự)',
                rationale_vi: 'Chủ ngữ "It" đi với động từ "is".',
                rationale_en: 'The subject "It" goes with the verb "is".'
            },
            {
                type: 'fill-in-the-blank',
                question: '191. List__ carefully.',
                correctAnswer: 'en',
                correctAnswer_vi: 'en',
                hint_vi: 'Từ có nghĩa là "nghe". (2 ký tự)',
                rationale_vi: 'Từ đúng là "Listen".',
                rationale_en: 'The correct word is "Listen".'
            },
            {
                type: 'fill-in-the-blank',
                question: '192. SCHOOL-B_G',
                correctAnswer: 'A',
                correctAnswer_vi: 'A',
                hint_vi: 'Từ có nghĩa là "cặp đi học". (1 ký tự)',
                rationale_vi: 'Từ ghép đúng là "SCHOOL-BAG".',
                rationale_en: 'The correct compound word is "SCHOOL-BAG".'
            },
            {
                type: 'multimedia',
                question: '193. This is my ... .',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206312195910030_Audio.mp3',
                options: [
                    { text: 'A. class', isCorrect: false },
                    { text: 'B. school', isCorrect: false },
                    { text: 'C. room', isCorrect: false },
                    { text: 'D. desk', isCorrect: true }
                ],
                correctAnswer: 'D. desk',
                correctAnswer_vi: 'bàn học',
                hint_vi: 'Nghe và chọn đồ vật.',
                rationale_vi: 'Bài nghe nói "This is my desk".',
                rationale_en: 'The audio says "This is my desk".'
            },
            {
                type: 'rearrange',
                question: '194. a pupil/ Primary School./ I am/ at Quang Trung/',
                words: ["I am", "a pupil", "at Quang Trung", "Primary School."],
                correctAnswer: "I am a pupil at Quang Trung Primary School.",
                correctAnswer_vi: 'Tôi là một học sinh tại trường tiểu học Quang Trung.',
                hint_vi: 'Giới thiệu bản thân.',
                rationale_vi: 'Câu này giới thiệu bản thân là học sinh của một trường cụ thể.',
                rationale_en: 'This sentence introduces oneself as a pupil at a specific school.'
            },
            {
                type: 'mc',
                question: '195. What does he do during ... lessons? - He learns about numbers.',
                options: [
                    { text: 'A. Maths', isCorrect: true },
                    { text: 'B. English', isCorrect: false },
                    { text: 'C. Arts', isCorrect: false },
                    { text: 'D. Music', isCorrect: false }
                ],
                correctAnswer: 'A. Maths',
                correctAnswer_vi: 'Toán',
                hint_vi: 'Môn học về các con số.',
                rationale_vi: 'Môn học mà chúng ta học về các con số ("numbers") là môn Toán ("Maths").',
                rationale_en: 'The subject where we learn about "numbers" is "Maths".'
            },
            {
                type: 'fill-in-the-blank',
                question: '196. We write "06:20" and we say "It’s twenty ____ six".',
                correctAnswer: 'past',
                correctAnswer_vi: 'past',
                hint_vi: 'Cách nói giờ hơn. (4 ký tự)',
                rationale_vi: 'Khi nói giờ hơn, ta dùng cấu trúc: phút + "past" + giờ. Ví dụ: 6 giờ 20 phút là "twenty past six".',
                rationale_en: 'When telling time after the hour, we use the structure: minutes + "past" + hour. E.g., 6:20 is "twenty past six".'
            },
            {
                type: 'multimedia',
                question: '197. What colour is ______?',
                mediaType: 'audio',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Audio/3-tn-59.mp3',
                options: [
                    { text: 'A. they', isCorrect: false },
                    { text: 'B. that', isCorrect: false },
                    { text: 'C. it', isCorrect: true },
                    { text: 'D. these', isCorrect: false }
                ],
                correctAnswer: 'C. it',
                correctAnswer_vi: 'nó',
                hint_vi: 'Nghe và chọn đại từ.',
                rationale_vi: 'Bài nghe hỏi "What colour is it?".',
                rationale_en: 'The audio asks "What colour is it?".'
            },
            {
                type: 'multimedia',
                question: '198. __OWN SHOES',
                mediaType: 'image',
                mediaSource: 'https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop3/Captruong/Images/3-dt-15.jpg',
                correctAnswer: 'BR',
                correctAnswer_vi: 'BR',
                hint_vi: 'Từ chỉ màu nâu. (2 ký tự)',
                rationale_vi: 'Từ đúng là "BROWN" (màu nâu).',
                rationale_en: 'The correct word is "BROWN".'
            },
            {
                type: 'fill-in-the-blank',
                question: '199. That is my fa__er.',
                correctAnswer: 'th',
                correctAnswer_vi: 'th',
                hint_vi: 'Từ có nghĩa là "bố". (2 ký tự)',
                rationale_vi: 'Từ đúng là "father".',
                rationale_en: 'The correct word is "father".'
            },
            {
                type: 'rearrange',
                question: '200. nice/ a/ puppy./ It\'s/',
                words: ["It's", "a", "nice", "puppy."],
                correctAnswer: "It's a nice puppy.",
                correctAnswer_vi: 'Nó là một chú cún con xinh xắn.',
                hint_vi: 'Bắt đầu với "It\'s".',
                rationale_vi: 'Câu mô tả một con vật: It\'s + a/an + adj + N.',
                rationale_en: 'Sentence describing an animal: It\'s + a/an + adj + N.'
            }
        ];
        
        // --- Component: MediaDisplay (Helper for Image/Audio rendering) ---
        const MediaDisplay = ({ question, showMessage }) => {
            if (question.mediaType === 'image') {
                return (
                    <div className="w-full p-4 bg-gray-100 rounded-xl mb-4 text-center border-2 border-dashed border-gray-300">
                        <p className="text-blue-600 font-bold mb-2">🖼️ Nhìn hình và trả lời</p>
                        <img 
                            src={question.mediaSource}
                            alt={`Hình ảnh IOE: ${question.imagePrompt || 'Chủ đề câu hỏi'}`} 
                            className="w-full max-w-xs mx-auto rounded-lg shadow-md border-2 border-gray-300"
                            crossOrigin="anonymous"
                            referrerPolicy="no-referrer"
                            onError={(e) => { 
                                e.target.onerror = null; 
                                e.target.src = `https://placehold.co/566x320/FF0000/FFFFFF?text=L%E1%BB%97I+T%E1%BA%A2I+%E1%BA%A2NH+(CORS)`; 
                                showMessage('Lỗi tải ảnh: File media có thể bị chặn bởi trình duyệt.', 'error');
                            }}
                        />
                        <p className="text-xs text-gray-500 mt-2 break-all">Link gốc: {question.mediaSource}</p>
                        {question.imagePrompt && <p className="text-sm text-blue-600 mt-2 font-medium">Gợi ý nội dung: {question.imagePrompt}</p>}
                    </div>
                );
            }

            if (question.mediaType === 'audio') {
                return (
                    <div className="w-full p-4 bg-gray-100 rounded-xl mb-4 text-center border-2 border-dashed border-gray-300">
                        <p className="text-blue-600 font-bold mb-2">🔊 Nghe và trả lời (Bấm Play)</p>
                        <audio 
                            controls
                            src={question.mediaSource}
                            className="w-full max-w-sm mx-auto my-2"
                            crossOrigin="anonymous"
                            referrerPolicy="no-referrer"
                            onError={() => {
                                showMessage('Lỗi tải Audio: File media có thể bị chặn.', 'error');
                            }}
                        >
                            <source src={question.mediaSource} type="audio/mp3" />
                            Trình duyệt của bạn không hỗ trợ phần tử audio.
                        </audio>
                        <p className="text-xs text-gray-500 mt-2 break-all">Link gốc: {question.mediaSource}</p>
                    </div>
                );
            }
            return null;
        }

        // --- Component: ProgressBar.tsx ---
        const ProgressBar = ({ percentage }) => {
            return (
                <div className="w-full h-2 bg-blue-100 rounded-full mt-4 overflow-hidden">
                    <div
                        className="h-full bg-blue-500 transition-all duration-500 ease-in-out"
                        style={{ width: `${percentage}%` }}
                    ></div>
                </div>
            );
        };
        
        // --- Component: MessageBox.tsx ---
        const MessageBox = ({ message, type }) => {
            const [visible, setVisible] = React.useState(false);

            React.useEffect(() => {
                if (message) {
                    setVisible(true);
                    const timer = setTimeout(() => {
                        setVisible(false);
                    }, 2700);
                    return () => clearTimeout(timer);
                } else {
                    setVisible(false);
                }
            }, [message, type]);

            const baseClasses = "fixed top-4 left-1/2 -translate-x-1/2 p-4 rounded-xl shadow-xl text-center font-bold text-lg z-50 transition-all duration-300 transform";
            
            const typeClasses = {
                success: 'bg-green-100 border border-green-500 text-green-800',
                error: 'bg-red-100 border-red-500 text-red-800',
                info: 'bg-yellow-100 border border-yellow-500 text-yellow-800',
            };

            const visibilityClasses = visible ? 'opacity-100 scale-100' : 'opacity-0 scale-90 pointer-events-none';

            return (
                <div className={`${baseClasses} ${typeClasses[type]} ${visibilityClasses}`}>
                    {message}
                </div>
            );
        };
        
        // --- Component: RationaleBox.tsx ---
        const RationaleBox = ({ question, isCorrect, submittedAnswer }) => {
            const boxClasses = `mt-6 p-4 rounded-xl border transition duration-300 fade-in border-l-4 ${
                isCorrect ? 'bg-green-100 border-green-600' : 'bg-red-100 border-red-600'
            }`;
            
            const submittedAnswerDisplay = () => {
                const isFillIn = question.type === 'fill-in-the-blank' || (question.type === 'multimedia' && !question.options);
                
                if(isCorrect && !isFillIn) return null;
                
                return (
                    <>
                        <strong className="text-gray-700">
                           Bạn đã chọn/Điền:
                        </strong>
                        <span className="text-red-700 font-medium break-words"> {submittedAnswer}</span>
                        <br/>
                    </>
                );
            }

            return (
                <div className={boxClasses}>
                    <p className="font-bold text-lg mb-2 text-blue-700">Giải thích:</p>
                    <div className="text-gray-700 space-y-1">
                        {!isCorrect && submittedAnswerDisplay()}
                        <p><strong>Đáp án đúng:</strong> <span className="text-green-800 font-semibold">{question.correctAnswer}</span></p>
                        
                        {question.correctAnswer_vi && (
                            <p><strong>Dịch nghĩa:</strong> <span className="text-green-600 font-medium">{question.correctAnswer_vi}</span></p>
                        )}
                        <p className="pt-2 border-t border-gray-300 mt-2">{question.rationale_vi || 'Không có giải thích chi tiết.'}</p>
                    </div>
                </div>
            );
        };

        // --- Component: FillInTheBlankQuestion.tsx ---
        const FillInTheBlankQuestion = ({ question, isAnswered, onSubmit, showMessage, questionIndex }) => {
            const [inputValue, setInputValue] = React.useState('');
            const inputRef = React.useRef(null);

            React.useEffect(() => {
                setInputValue('');
                if (inputRef.current && !isAnswered) {
                    inputRef.current.focus();
                }
            }, [question, isAnswered]);

            const handleSubmitClick = () => {
                const trimmedInput = inputValue.trim();
                if (trimmedInput === '') {
                    showMessage('Vui lòng điền câu trả lời của bạn!', 'info');
                    return;
                }
                const isCorrect = trimmedInput.toLowerCase() === question.correctAnswer.toLowerCase();
                onSubmit(trimmedInput, isCorrect);
            };
            
            const questionTextParts = React.useMemo(() => {
                let text = question.question.replace(/^\d+\.\s*/, '');
                
                const markers = ['____', '________', '__________', '___________', '_________', '_______', '______', '_____', '___', '__', '_'];

                for (const marker of markers) {
                    if (text.includes(marker)) {
                        const parts = text.split(marker);
                        return [parts[0], parts.slice(1).join(marker)];
                    }
                }
                 // Handle partial words like `c__se`
                const partialMatch = text.match(/(.*)__+(.*)/) || text.match(/(.*)\_+(.*)/);
                if (partialMatch) {
                    return [partialMatch[1], partialMatch[2]];
                }

                return [text, '']; 
            }, [question.question]);
            
            let inputClasses = 'inline-block mx-2 p-2 border-2 rounded-lg text-xl text-center shadow-sm transition duration-200 align-baseline w-48 font-mono font-bold';
            if (isAnswered) {
                const isSubmissionCorrect = inputValue.trim().toLowerCase() === question.correctAnswer.toLowerCase();
                inputClasses += isSubmissionCorrect ? ' border-green-500 bg-green-50' : ' border-red-500 bg-red-50';
            } else {
                inputClasses += ' border-gray-300 focus:border-blue-500';
            }

            const inputWidthStyle = {
                width: `${Math.max(6, question.correctAnswer.length * 2)}rem`, 
                maxWidth: '100%',
            };


            return (
                <div className="space-y-4">
                     {question.mediaType && <MediaDisplay question={question} showMessage={showMessage} />}
                    <div className="text-2xl sm:text-3xl font-bold mb-6 leading-relaxed text-center flex justify-center items-center flex-wrap">
                        <span className="mr-2">{questionIndex + 1}.</span>
                        {questionTextParts[0] && <span>{questionTextParts[0]}</span>}
                        <input
                            ref={inputRef}
                            type="text"
                            value={inputValue}
                            onChange={(e) => setInputValue(e.target.value)}
                            disabled={isAnswered}
                            placeholder={isAnswered ? question.correctAnswer : ""}
                            className={inputClasses}
                            style={inputWidthStyle}
                            onKeyPress={(e) => e.key === 'Enter' && !isAnswered && handleSubmitClick()}
                            aria-label="Fill in the blank"
                        />
                        {questionTextParts[1] && <span>{questionTextParts[1]}</span>}
                    </div>
                    <button
                        onClick={handleSubmitClick}
                        disabled={isAnswered}
                        className="w-full py-3 px-4 bg-green-600 text-white font-extrabold text-xl rounded-lg shadow-md transition duration-300 hover:bg-green-700 mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98"
                    >
                        Kiểm Tra
                    </button>
                </div>
            );
        };
        
        // --- Component: MultipleChoiceQuestion.tsx ---
        const MultipleChoiceQuestion = ({ question, isAnswered, onSubmit, showMessage, questionIndex }) => {
            const [selectedIndex, setSelectedIndex] = React.useState(null);

            React.useEffect(() => {
                setSelectedIndex(null);
            }, [question]);

            const handleSubmitClick = () => {
                if (selectedIndex === null) {
                    showMessage('Vui lòng chọn một đáp án!', 'info');
                    return;
                }
                const selectedOption = question.options[selectedIndex];
                onSubmit(selectedOption.text, selectedOption.isCorrect);
            };

            return (
                <>
                    {question.mediaType && <MediaDisplay question={question} showMessage={showMessage} />}
                    
                    <h3
                        className="text-2xl sm:text-3xl font-bold mb-6 leading-relaxed"
                        dangerouslySetInnerHTML={{ __html: `${questionIndex + 1}. ${question.question.replace(/^\d+\.\s*/, '')}` }}
                    />
                    <div className="space-y-4">
                        <div className="space-y-3">
                            {question.options.map((option, index) => {
                                const isSelected = selectedIndex === index;
                                let labelClasses = "block p-4 border-2 rounded-xl shadow-md text-xl font-bold transition duration-200";

                                if (isAnswered) {
                                    labelClasses += " cursor-default";
                                    if (option.isCorrect) {
                                        labelClasses += " bg-green-100 border-green-500";
                                    } else if (isSelected) {
                                        labelClasses += " bg-red-100 border-red-500";
                                    } else {
                                        labelClasses += " border-gray-200 opacity-60";
                                    }
                                } else {
                                    labelClasses += " cursor-pointer hover:bg-blue-50 hover:border-blue-300";
                                    if(isSelected) {
                                        labelClasses += " bg-blue-100 border-blue-500";
                                    } else {
                                        labelClasses += " border-gray-200";
                                    }
                                }

                                return (
                                    <div key={index} className="relative">
                                        <input
                                            type="radio"
                                            id={`option-${questionIndex}-${index}`}
                                            name={`mc-option-${questionIndex}`}
                                            value={index}
                                            className="hidden"
                                            checked={isSelected}
                                            onChange={() => setSelectedIndex(index)}
                                            disabled={isAnswered}
                                        />
                                        <label htmlFor={`option-${questionIndex}-${index}`} className={labelClasses} dangerouslySetInnerHTML={{ __html: option.text }}></label>
                                    </div>
                                );
                            })}
                        </div>
                        <button
                            onClick={handleSubmitClick}
                            disabled={isAnswered}
                            className="w-full py-3 px-4 bg-green-600 text-white font-extrabold text-xl rounded-lg shadow-md transition duration-300 hover:bg-green-700 mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98"
                        >
                            Kiểm Tra
                        </button>
                    </div>
                </>
            );
        };
        
        // --- Component: RearrangeQuestion.tsx ---
        const WordBlock = ({ word, onClick, isSource, isAnswered }) => {
            const baseClasses = 'word-block px-4 py-2 text-xl font-bold rounded-lg shadow-sm transition-all duration-150 break-words transform active:scale-95';
            const sourceClasses = isSource ? 'bg-blue-100 text-blue-800 hover:bg-blue-200' : 'bg-gray-100 text-gray-800 border-b-2 border-gray-300';
            const disabledClasses = 'opacity-60 cursor-default shadow-inner';
            const interactiveClasses = 'cursor-pointer';

            return (
                <span
                    onClick={!isAnswered ? onClick : undefined}
                    className={`${baseClasses} ${sourceClasses} ${isAnswered ? disabledClasses : interactiveClasses}`}
                >
                    {word.text}
                </span>
            );
        };

        const RearrangeQuestion = ({ question, isAnswered, onSubmit, showMessage, questionIndex, isCorrect }) => {
            const [sentenceWords, setSentenceWords] = React.useState([]);
            
            const initialSourceWords = React.useMemo(() => {
                return [...question.words]
                    .map((text) => ({ id: crypto.randomUUID(), text })) 
                    .sort(() => Math.random() - 0.5);
            }, [question]);

            const [sourceWords, setSourceWords] = React.useState(initialSourceWords);

            React.useEffect(() => {
                setSourceWords(initialSourceWords);
                setSentenceWords([]);
            }, [initialSourceWords]);

            const handleSelectWord = (word) => {
                setSourceWords(prev => prev.filter(w => w.id !== word.id));
                setSentenceWords(prev => [...prev, word]);
            };

            const handleReturnWord = (word) => {
                setSentenceWords(prev => prev.filter(w => w.id !== word.id));
                setSourceWords(prev => [...prev, word].sort((a, b) => initialSourceWords.findIndex(sw => sw.id === a.id) - initialSourceWords.findIndex(sw => sw.id === b.id)));
            };

            const handleSubmitClick = () => {
                if (sentenceWords.length === 0) {
                    showMessage('Vui lòng sắp xếp các từ!', 'info');
                    return;
                }
                
                const submitted = sentenceWords.map(w => w.text).join(' ').replace(/\s+([.,?!])/g, '$1').trim();
                const normalize = (str) => str.replace(/’/g, "'").replace(/[.,?!]/g, '').replace(/\s+/g, ' ').toLowerCase().trim();
                
                const isCorrectResult = normalize(submitted) === normalize(question.correctAnswer);
                onSubmit(submitted, isCorrectResult);
            };

            return (
                <>
                    <h3
                        className="text-2xl sm:text-3xl font-bold mb-6 leading-relaxed"
                        dangerouslySetInnerHTML={{ __html: `${questionIndex + 1}. ${question.question.replace(/^\d+\.\s*/, '')}` }}
                    />
                    <div className="space-y-4">
                        <div className={`min-h-[70px] p-3 border-2 rounded-xl shadow-inner flex flex-wrap gap-2 items-center transition duration-300 ${isAnswered ? (isCorrect ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50') : 'border-blue-300 bg-blue-50 border-dashed'}`}>
                            {sentenceWords.length === 0 && !isAnswered ? (
                                <span className="text-gray-500 italic text-base">Chạm vào các từ bên dưới để xây dựng câu trả lời...</span>
                            ) : (
                                sentenceWords.map(word => (
                                    <WordBlock key={word.id} word={word} onClick={() => handleReturnWord(word)} isSource={false} isAnswered={isAnswered} />
                                ))
                            )}
                        </div>
                        
                        <div className="min-h-[120px] p-4 bg-gray-100 rounded-xl shadow-md flex flex-wrap gap-2 items-center border border-gray-200">
                            {sourceWords.map(word => (
                                <WordBlock key={word.id} word={word} onClick={() => handleSelectWord(word)} isSource={true} isAnswered={isAnswered} />
                            ))}
                        </div>
                        <button
                            onClick={handleSubmitClick}
                            disabled={isAnswered}
                            className="w-full py-3 px-4 bg-green-600 text-white font-extrabold text-xl rounded-lg shadow-md transition duration-300 hover:bg-green-700 mt-4 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98"
                        >
                            Kiểm Tra
                        </button>
                    </div>
                </>
            );
        };
        
        // --- Component: StartScreen.tsx ---
        const StartScreen = ({ onStart, totalQuestions }) => {
            const [name, setName] = React.useState('');

            const handleStart = () => {
                if (name.trim()) {
                    onStart(name.trim());
                }
            };

            const isButtonDisabled = name.trim() === '';

            return (
                <div className="fade-in text-center p-4">
                    <header className="mb-8">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-blue-600 mb-2">BỘ ĐỀ ÔN IOE K3 SỐ: 02.2</h1>
                        <p className="text-xl text-gray-500">Bộ đề luyện thi IOE dành cho khối 3</p>
                    </header>
                    <div className="max-w-md mx-auto bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                        <h2 className="text-2xl font-bold mb-4 text-gray-700">Chào mừng bé!</h2>
                        <p className="text-gray-600 mb-6 text-lg">Mỗi câu trả lời đúng được cộng 10 điểm. Bài thi có {totalQuestions} câu.</p>
                        <div className="space-y-4">
                            <label htmlFor="player-name" className="block text-base font-medium text-gray-700 text-left">Nhập tên của bé để bắt đầu:</label>
                            <input
                                type="text"
                                id="player-name"
                                placeholder="Tên của bé"
                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg shadow-sm transition duration-150"
                                maxLength={50}
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && !isButtonDisabled && handleStart()}
                            />
                            <button
                                onClick={handleStart}
                                disabled={isButtonDisabled}
                                className="w-full py-3 px-4 bg-yellow-400 text-yellow-900 font-extrabold rounded-xl shadow-lg transition duration-300 hover:bg-yellow-500 disabled:bg-gray-300 disabled:cursor-not-allowed text-2xl active:scale-98"
                            >
                                Bắt Đầu
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // --- Component: EndScreen.tsx ---
        const EndScreen = ({ playerName, score, totalQuestions, onRestart, onReview }) => {
            const maxScore = totalQuestions * 10;
            const percentage = maxScore > 0 ? (score / maxScore) * 100 : 0;
            
            let encouragement = "Cố gắng hơn ở lần sau nhé!";
            if (percentage >= 90) {
                encouragement = "Xuất sắc! Bé thật là giỏi!";
            } else if (percentage >= 70) {
                encouragement = "Làm tốt lắm! Chỉ cần cố gắng thêm một chút nữa thôi.";
            } else if (percentage >= 50) {
                encouragement = "Khá tốt! Hãy tiếp tục ôn luyện nhé.";
            }

            return (
                <div className="text-center fade-in p-4">
                    <h2 className="text-4xl font-extrabold mb-2 text-green-600">🎉 Hoàn Thành! 🎉</h2>
                    <p className="text-2xl text-gray-700 mb-4">
                        Chúc mừng, <span className="font-extrabold text-blue-600">{playerName}</span>!
                    </p>
                     <p className="text-lg text-gray-600 mb-6">{encouragement}</p>
                    <div className="bg-white p-8 rounded-xl shadow-lg inline-block border border-gray-100">
                        <p className="text-2xl font-bold mb-8 text-gray-700">Điểm số của bé:</p>
                        <p className={`text-7xl font-black mb-10 text-blue-700`}>
                            {score} / {maxScore}
                        </p>
                    </div>
                    <div className="mt-8 flex flex-col sm:flex-row justify-center items-center gap-4">
                        {onReview && (
                             <button
                                onClick={onReview}
                                className="py-3 px-6 bg-yellow-500 text-white font-bold rounded-xl shadow-lg transition duration-300 hover:bg-yellow-600 text-lg active:scale-98"
                            >
                                Xem lại câu sai
                            </button>
                        )}
                        <button
                            onClick={onRestart}
                            className="py-3 px-6 bg-blue-500 text-white font-bold rounded-xl shadow-lg transition duration-300 hover:bg-blue-600 text-lg active:scale-98"
                        >
                            Làm lại bài thi
                        </button>
                    </div>
                </div>
            );
        };

        // --- Component: ReviewScreen.tsx ---
        const ReviewScreen = ({ incorrectAnswers, onBack }) => {
            return (
                <div className="fade-in">
                    <header className="text-center mb-8">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-yellow-600 mb-2">Ôn tập các câu sai</h1>
                    </header>
                    <div className="space-y-8">
                        {incorrectAnswers.map(({ question, submittedAnswer }, index) => (
                            <div key={index} className="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                                <h3 className="text-2xl sm:text-3xl font-bold mb-4 leading-relaxed"
                                    dangerouslySetInnerHTML={{ __html: `${index + 1}. ${question.question.replace(/^\d+\.\s*/, '')}` }}
                                />
                                {question.mediaType && <MediaDisplay question={question} showMessage={() => {}} />}
                                <RationaleBox question={question} isCorrect={false} submittedAnswer={submittedAnswer} />
                            </div>
                        ))}
                    </div>
                    <div className="mt-8 text-center">
                        <button
                            onClick={onBack}
                            className="py-3 px-6 bg-blue-500 text-white font-bold rounded-xl shadow-lg transition duration-300 hover:bg-blue-600 text-lg active:scale-98"
                        >
                            Quay lại màn hình điểm
                        </button>
                    </div>
                </div>
            );
        };
        
        // --- Component: QuizScreen.tsx ---
        const QuizScreen = ({ playerName, onEnd, totalQuestions, questionSet }) => {
            const [currentQuestionIndex, setCurrentQuestionIndex] = React.useState(0);
            const [score, setScore] = React.useState(0);
            const [isAnswered, setIsAnswered] = React.useState(false);
            const [isCorrect, setIsCorrect] = React.useState(false);
            const [submittedAnswer, setSubmittedAnswer] = React.useState('');
            const [isHintVisible, setIsHintVisible] = React.useState(false);
            const [message, setMessage] = React.useState(null);
            const incorrectAnswersRef = React.useRef([]);

            const currentQuestion = questionSet[currentQuestionIndex];

            React.useEffect(() => {
                incorrectAnswersRef.current = [];
            }, [questionSet]);

             React.useEffect(() => {
                setIsAnswered(false);
                setIsCorrect(false);
                setSubmittedAnswer('');
                setIsHintVisible(false);
                setMessage(null);
            }, [currentQuestionIndex]);
            
            const showMessage = (text, type) => {
                setMessage({ text, type });
            };

            const handleSubmit = (answer, isAnswerCorrect) => {
                if (isAnswered) return;
                
                setIsAnswered(true);
                setSubmittedAnswer(answer);
                setIsCorrect(isAnswerCorrect);

                if (isAnswerCorrect) {
                    setScore(prev => prev + 10);
                    showMessage('CHÍNH XÁC! +10 điểm', 'success');
                } else {
                    showMessage('SAI RỒI! Hãy xem lại nhé.', 'error');
                    incorrectAnswersRef.current.push({ question: currentQuestion, submittedAnswer: answer });
                }
            };

            const handleNext = () => {
                if (currentQuestionIndex < totalQuestions - 1) {
                    setCurrentQuestionIndex(prev => prev + 1);
                } else {
                    onEnd(score, incorrectAnswersRef.current);
                }
            };

            if (!currentQuestion) {
                return <div className="text-center p-8">Đang tải câu hỏi...</div>;
            }

            const progressPercentage = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            
            const renderQuestionComponent = () => {
                const commonProps = {
                    question: currentQuestion,
                    isAnswered,
                    onSubmit: handleSubmit,
                    showMessage,
                    questionIndex: currentQuestionIndex,
                    isCorrect: isCorrect, 
                };

                if (currentQuestion.type === 'rearrange') {
                    return <RearrangeQuestion {...commonProps} />;
                }
                if (currentQuestion.type === 'mc' || (currentQuestion.type === 'multimedia' && currentQuestion.options)) {
                    return <MultipleChoiceQuestion {...commonProps} />;
                }
                if (currentQuestion.type === 'fill-in-the-blank' || (currentQuestion.type === 'multimedia' && !currentQuestion.options)) {
                    return <FillInTheBlankQuestion {...commonProps} />;
                }
                
                return <div className="text-red-500">Lỗi: Loại câu hỏi không xác định.</div>;
            };

            return (
                <div className="fade-in">
                    {message && <MessageBox message={message.text} type={message.type} />}
                    <header className="text-center mb-8">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-blue-600 mb-2">BỘ ĐỀ ÔN IOE K3 SỐ: 02.2</h1>
                        <ProgressBar percentage={progressPercentage} />
                    </header>

                    <div className="flex justify-between items-center mb-6 py-2 px-4 bg-blue-50 rounded-xl shadow-inner border border-blue-100">
                        <p className="text-lg font-medium text-blue-800">Bé: <span className="font-bold">{playerName}</span></p>
                        <p className="text-lg font-medium text-blue-800">Điểm: <span className="text-2xl font-extrabold text-red-600">{score}</span></p>
                        <p className="text-lg font-medium text-blue-800">Câu: <span className="font-bold">{currentQuestionIndex + 1}/{totalQuestions}</span></p>
                    </div>

                    <div className="mb-8">
                        {renderQuestionComponent()}
                    </div>

                    <div className="mt-8 border-t pt-6 flex justify-between items-center flex-wrap gap-4">
                        <div className="relative">
                            <button
                                className="bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 hover:bg-yellow-600 active:scale-95"
                                onMouseEnter={() => setIsHintVisible(true)}
                                onMouseLeave={() => setIsHintVisible(false)}
                                onTouchStart={() => setIsHintVisible(true)}
                                onTouchEnd={() => setIsHintVisible(false)}
                            >
                                Gợi ý
                            </button>
                            <div className={`absolute bottom-full mb-2 w-max max-w-[90vw] sm:max-w-sm p-4 bg-yellow-100 border-l-4 border-yellow-500 rounded-xl shadow-lg transition-all duration-300 transform origin-bottom-left ${isHintVisible ? 'opacity-100 scale-100' : 'opacity-0 scale-90 pointer-events-none'}`}>
                                <p className="font-semibold text-yellow-800">Gợi ý:</p>
                                <p className="text-yellow-700">{currentQuestion.hint_vi || 'Không có gợi ý.'}</p>
                            </div>
                        </div>
                        
                        <button onClick={handleNext} disabled={!isAnswered} className="flex-grow py-3 px-4 bg-blue-500 text-white font-extrabold text-xl rounded-xl shadow-xl transition duration-300 hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed active:scale-98">
                            {currentQuestionIndex === totalQuestions - 1 ? 'Hoàn thành' : 'Câu tiếp theo'}
                        </button>
                    </div>

                    {isAnswered && (
                        <RationaleBox question={currentQuestion} isCorrect={isCorrect} submittedAnswer={submittedAnswer} />
                    )}
                </div>
            );
        };
        
        // --- Component: App.tsx ---
        const App = () => {
            const [gameState, setGameState] = React.useState('start');
            const [playerName, setPlayerName] = React.useState('');
            const [score, setScore] = React.useState(0);
            const [shuffledQuestions, setShuffledQuestions] = React.useState([]);
            const [incorrectAnswers, setIncorrectAnswers] = React.useState([]);

            React.useEffect(() => {
                const array = [...questions];
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                setShuffledQuestions(array);
            }, []);

            const handleStartQuiz = (name) => {
                setPlayerName(name);
                setScore(0);
                setIncorrectAnswers([]);
                setGameState('quiz');
            };

            const handleEndQuiz = (finalScore, mistakes) => {
                setScore(finalScore);
                setIncorrectAnswers(mistakes);
                setGameState('end');
            };
            
            const handleRestartQuiz = () => {
                 const array = [...questions];
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                setShuffledQuestions(array);
                setGameState('start');
            };

            const handleReview = () => {
                setGameState('review');
            };

             const handleBackToEndScreen = () => {
                setGameState('end');
            };

            const renderContent = () => {
                switch (gameState) {
                    case 'quiz':
                        return <QuizScreen 
                                    playerName={playerName} 
                                    onEnd={handleEndQuiz} 
                                    totalQuestions={shuffledQuestions.length}
                                    questionSet={shuffledQuestions}
                                />;
                    case 'end':
                        return <EndScreen 
                                    playerName={playerName} 
                                    score={score} 
                                    totalQuestions={shuffledQuestions.length}
                                    onRestart={handleRestartQuiz} 
                                    onReview={incorrectAnswers.length > 0 ? handleReview : null}
                                />;
                    case 'review':
                        return <ReviewScreen 
                                    incorrectAnswers={incorrectAnswers}
                                    onBack={handleBackToEndScreen}
                                />;
                    default:
                         return <StartScreen onStart={handleStartQuiz} totalQuestions={questions.length} />;
                }
            };

            return (
                <div className="p-4 sm:p-8 flex justify-center items-start min-h-screen">
                    <div className="w-full max-w-3xl bg-white rounded-xl shadow-2xl p-6 sm:p-8 md:p-10 border border-gray-100 min-h-[80vh]">
                        {renderContent()}
                    </div>
                </div>
            );
        };
        
        // --- Entry point from index.tsx ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>
